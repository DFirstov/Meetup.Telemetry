# Телеметрия в .NET: как затащить быстро и почти бесплатно

Телеметрия — это инструменты для наблюдения за приложением. В этом проекте даны примеры использования трёх инструментов телеметрии в распределённой системе на .NET: логирование, метрики и трассировка. Телеметрия добавляется в тестовый проект интернет-магазина (только backend). Для телеметрии используются только бесплатные инструменты с открытым исходным кодом. Тестовые микросервисы и все инструменты телеметрии поднимаются с помощью [docker-compose](https://docs.docker.com/compose/).

## Тестовая система

Тестовая система состоит из трёх микросервисов на ASP.NET Web API:

* [Payments](Payments/Program.cs) — пример сервиса для проведения оплаты. На каждый запрос генерирует случайные данные о пользователе и его балансе. Затем проверяет, достаточно ли у пользователя средств для совершения покупки. Если денег хватает, возвращает успешный ответ. Если нет, возвращает ошибку 400.
* [Stock](Stock/Program.cs) — пример сервиса для работы со складом. Может возвращать список продуктов, доступных на складе, и позволяет бронировать определённый продукт. При бронировании продукта случайным образом определяет, доступен ли он на складе. Если доступен, то возвращает успешный ответ. Если нет, возвращает ошибку 400.
* [Shop](Shop/Program.cs) — пример сервиса витрины интернет-магазина. Позволяет получить список товаров со склада и принимает запросы на покупку продукта. Перед покупкой проверяет, доступен ли продукт на складе. Если доступен, то проводит оплату. Если оплата прошла успешно, то возвращает успешный ответ. Если продукт недоступен или оплата не прошла, возвращает ошибку 400.

Кроме этого, есть тестовый клиент [LoadTest](LoadTest/Program.cs), который бесконечно отправляет запросы на покупку продукта в магазин.

Запустить тестовую систему можно с помощью docker-compose:

```bash
docker-compose up
```

Системы начнут обмениваться запросами (честное слово!), но мы об этом не узнаем, т. к. у нас нет никакой телеметрии. Остановить систему можно с помощью `Ctrl+C`.

Чтобы начать затаскивать телеметрию, переключитесь на ветку `1-1-add-logs`:

```bash
git checkout 1-1-add-logs
```
